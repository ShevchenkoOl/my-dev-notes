// API (Application Programming Interface ‚Äî —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–æ–∫) ‚Äî —Ü–µ –Ω–∞–±—ñ—Ä –ø—Ä–∞–≤–∏–ª —ñ –º–µ—Ç–æ–¥—ñ–≤, –∑ –¥–æ–ø–æ–º–æ–≥–æ—é —è–∫–∏—Ö –æ–¥–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞ –º–æ–∂–µ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ —ñ–Ω—à–æ—é.
// üëâ –ü—Ä–∏–∫–ª–∞–¥:
//            - –£ —Ç–µ–±–µ —î –¥–æ–¥–∞—Ç–æ–∫-–ø–æ–≥–æ–¥–∞. –í—ñ–Ω –Ω–µ –∑–±–∏—Ä–∞—î –¥–∞–Ω—ñ —Å–∞–º, –∞ –∑–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ API –ø–æ–≥–æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É —ñ –æ—Ç—Ä–∏–º—É—î –¥–∞–Ω—ñ (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É, –≤–æ–ª–æ–≥—ñ—Å—Ç—å —Ç–æ—â–æ). –¢–∏, —è–∫ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫, –º–æ–∂–µ—à –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ–π API, —â–æ–± –≤–±—É–¥—É–≤–∞—Ç–∏ –ø–æ–≥–æ–¥—É –≤ —Å–≤–æ—î –¥–æ–¥–∞—Ç–æ–∫.

// REST API ‚Äî —Ü–µ –æ–¥–∏–Ω –∑ –≤–∏–¥—ñ–≤ API, –æ—Å–Ω–æ–≤–∞–Ω–∏–π –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö REST (Representational State Transfer). –í—ñ–Ω —á–∞—Å—Ç—ñ—à–µ –∑–∞ –≤—Å–µ –ø—Ä–∞—Ü—é—î —á–µ—Ä–µ–∑ HTTP (—è–∫ –∑–≤–∏—á–∞–π–Ω—ñ —Å–∞–π—Ç–∏). –∞–±–æ —Ü–µ –Ω–∞–±—ñ—Ä –ø—Ä–∞–≤–∏–ª –∞–±–æ –º–µ—Ç–æ–¥—ñ–≤, —â–æ –¥–∞—é—Ç—å –∑–º–æ–≥—É –∫–ª—ñ—î–Ω—Ç–∞–º (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –±—Ä–∞—É–∑–µ—Ä—É –∞–±–æ –º–æ–±—ñ–ª—å–Ω–æ–º—É –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É) –≤—ñ–¥–ø—Ä–∞–≤–ª—è—Ç–∏ HTTP-–∑–∞–ø–∏—Ç–∏ (GET, POST, PUT, DELETE) –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ —Ç–∞ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ —É —Ñ–æ—Ä–º–∞—Ç—ñ JSON –∞–±–æ XML.

// –ó–∞–≥–∞–ª—å–Ω—ñ –≤–∏–¥–∏ API:
// üîπ 1. REST API: –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ HTTP —ñ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö REST, –ß–∞—Å—Ç—ñ—à–µ –∑–∞ –≤—Å–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É –≤–µ–±-—Ä–æ–∑—Ä–æ–±—Ü—ñ, –ü—Ä–æ—Å—Ç–∏–π —ñ –∑—Ä–æ–∑—É–º—ñ–ª–∏–π. –ü—Ä–∏–∫–ª–∞–¥–∏: GitHub API, Telegram Bot API

// üîπ 2. SOAP API (Simple Object Access Protocol): –ë—ñ–ª—å—à —Å—Ç—Ä–æ–≥–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ REST, // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î XML –¥–ª—è –æ–±–º—ñ–Ω—É –¥–∞–Ω–∏–º–∏, –í–∏–º–∞–≥–∞—î WSDL (–æ–ø–∏—Å—É —Å—Ç—Ä—É–∫—Ç—É—Ä–∏). –ü—Ä–∏–∫–ª–∞–¥–∏: —Å—Ç–∞—Ä—ñ –±–∞–Ω–∫—ñ–≤—Å—å–∫—ñ —ñ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏ - üõ†Ô∏è –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, –∫–æ–ª–∏ –≤–∞–∂–ª–∏–≤—ñ –±–µ–∑–ø–µ–∫–∞ —ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü—ñ—è

// üîπ 3. GraphQL API: –†–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π Facebook —è–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ REST, –ö–ª—ñ—î–Ω—Ç —Å–∞–º –≤–∏–±–∏—Ä–∞—î, —è–∫—ñ –ø–æ–ª—è –æ—Ç—Ä–∏–º–∞—Ç–∏, –û–¥–∏–Ω endpoint –∑–∞–º—ñ—Å—Ç—å –±–∞–≥–∞—Ç—å–æ—Ö, –î–∞–Ω—ñ –ø—Ä–∏—Ö–æ–¥—è—Ç—å —É —Ñ–æ—Ä–º–∞—Ç—ñ JSON. –ü–µ—Ä–µ–≤–∞–≥–∞: –º–µ–Ω—à–µ –¥–∞–Ω–∏—Ö –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è, –≥–Ω—É—á–∫—ñ—à–µ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

// üîπ 4. WebSocket API: –ü–æ—Å—Ç—ñ–π–Ω–µ –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—î –∑'—î–¥–Ω–∞–Ω–Ω—è –º—ñ–∂ –∫–ª—ñ—î–Ω—Ç–æ–º —ñ —Å–µ—Ä–≤–µ—Ä–æ–º, –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—É: —á–∞—Ç–∏, —ñ–≥—Ä–∏, –±—ñ—Ä–∂—ñ, –ü—Ä–∞—Ü—é—î –ø–æ–≤–µ—Ä—Ö TCP, –∞ –Ω–µ —è–∫ –∑–≤–∏—á–∞–π–Ω—ñ HTTP-–∑–∞–ø–∏—Ç–∏

// üîπ 5. gRPC (Google Remote Procedure Call): –†–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π Google, –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î protobuf (–∞ –Ω–µ JSON –∞–±–æ XML), –î—É–∂–µ —à–≤–∏–¥–∫–∏–π, –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å—ñ–≤. –ß–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –≤–µ–ª–∏–∫–∏—Ö backend-—Å–∏—Å—Ç–µ–º

// üîπ 6. SDK/API —á–µ—Ä–µ–∑ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏: –¶–µ –º–æ–∂–µ –±—É—Ç–∏ API –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ –∞–±–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞, –¥–æ—Å—Ç—É–ø–Ω–∏–π —á–µ—Ä–µ–∑ –∫–æ–¥. –ü—Ä–∏–∫–ª–∞–¥–∏: DOM API –≤ –±—Ä–∞—É–∑–µ—Ä—ñ, Java API (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, File, Scanner), Python API –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ Pandas, Tkinter

// üîπ 7. –û–ø–µ—Ä–∞—Ü—ñ–π–Ω—ñ —Å–∏—Å—Ç–µ–º–Ω—ñ API: –¶–µ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏, —á–µ—Ä–µ–∑ —è–∫—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ —Å–ø—ñ–ª–∫—É—é—Ç—å—Å—è –∑ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—é —Å–∏—Å—Ç–µ–º–æ—é. –ü—Ä–∏–∫–ª–∞–¥–∏: Windows API, POSIX API (–¥–ª—è Unix-–ø–æ–¥—ñ–±–Ω–∏—Ö —Å–∏—Å—Ç–µ–º)


// –ü—Ä–æ–º—ñ–∂–Ω–µ –ø—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è (middleware):
// Middleware ‚Äî —Ü–µ —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å –æ–±—Ä–æ–±–∫–∏ –∑–∞–ø–∏—Ç—É –¥–æ —Å–µ—Ä–≤–µ—Ä–∞, –∞–ª–µ –ø–µ—Ä–µ–¥ —Ç–∏–º, —è–∫ –±—É–¥–µ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å.
import express from "express";
import moment from "moment"; // –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ Moment.js –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –¥–∞—Ç–∞–º–∏ –∞–ª–µ –≤–æ–Ω–∞ —Ç—Ä–æ–∑–∏ –∑–∞—Å—Ç–∞—Ä—ñ–ª–∞ —ñ –∫—Ä–∞—â–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ date-fns –∞–±–æ luxon
const app = express();
// –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –º–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ middleware –¥–ª—è –ª–æ–≥—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤, –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫ –∞–±–æ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.
app.use(async(req, res, next) => {   // next() ‚Äî —Ü–µ —Ñ—É–Ω–∫—Ü—ñ—è, —è–∫–∞ –ø–µ—Ä–µ–¥–∞—î —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É middleware –∞–±–æ –æ–±—Ä–æ–±–Ω–∏–∫—É –º–∞—Ä—à—Ä—É—Ç—É. –Ø–∫—â–æ –Ω–µ –±—É–¥–µ next(), –∑–∞–ø–∏—Ç "–∑–∞–≤–∏—Å–Ω–µ", —Ç–æ–±—Ç–æ —Å–µ—Ä–≤–µ—Ä –≤–∏–∫–æ–Ω–∞—î —Ü–µ–π –∑–∞–ø–∏—Ç —ñ –∑—É–ø–∏–Ω–∏–∏—å—Å—è, –∞ –¥–æ —Å–≤–æ–≥–æ –º–∞—Ä—à–ø–∫—Ç–∫ —è–∫–∏–π –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–µ –¥—ñ–π–¥–µ.
  
    // –¢—É—Ç –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –ª–æ–≥—ñ–∫—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ª–æ–≥—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤
    const { method, url } = req;
    console.log(`–ó–∞–ø–∏—Ç: ${req.method} ${req.url}`);
    const date = moment().format("YYYY-MM-DD HH:mm:ss"); // moment() –ø–æ—Ö–æ–¥–∏—Ç—å –∑ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ Moment.js ‚Äî —Ü–µ –ø–æ–ø—É–ª—è—Ä–Ω–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ JavaScript –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –¥–∞—Ç–∞–º–∏ —Ç–∞ —á–∞—Å–æ–º. moment() ‚Äî —Ü–µ —Ñ—É–Ω–∫—Ü—ñ—è, —è–∫–∞ —Å—Ç–≤–æ—Ä—é—î –æ–±'—î–∫—Ç –¥–∞—Ç–∏/—á–∞—Å—É. –í–æ–Ω–∞ –¥–æ–∑–≤–æ–ª—è—î –ª–µ–≥–∫–æ: –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –¥–∞—Ç—É –π —á–∞—Å; –ø–∞—Ä—Å–∏—Ç–∏ —Å—Ç—Ä–æ–∫–∏ —É —Ñ–æ—Ä–º–∞—Ç—ñ –¥–∞—Ç–∏; —Ñ–æ—Ä–º–∞—Ç—É–≤–∞—Ç–∏ –¥–∞—Ç—É –≤ –∑—Ä—É—á–Ω–∏–π –≤–∏–≥–ª—è–¥; –¥–æ–¥–∞–≤–∞—Ç–∏/–≤—ñ–¥–Ω—ñ–º–∞—Ç–∏ –¥–Ω—ñ, –º—ñ—Å—è—Ü—ñ, —Ä–æ–∫–∏ —Ç–æ—â–æ.
    try {
        await fs.appendFile("./public/logs.txt", `${date} - ${method} ${url}\n`); // fs.appendFile ‚Äî —Ü–µ —Ñ—É–Ω–∫—Ü—ñ—è –∑ –º–æ–¥—É–ª—è fs (file system), —è–∫–∞ –¥–æ–¥–∞—î —Ç–µ–∫—Å—Ç –¥–æ —Ñ–∞–π–ª—É. –Ø–∫—â–æ —Ñ–∞–π–ª –Ω–µ —ñ—Å–Ω—É—î, –≤—ñ–Ω –±—É–¥–µ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π. –£ –Ω–∞—à–æ–º—É –≤–∏–ø–∞–¥–∫—É –º–∏ –∑–∞–ø–∏—Å—É—î–º–æ –¥–∞—Ç—É, –º–µ—Ç–æ–¥ –∑–∞–ø–∏—Ç—É —Ç–∞ URL —É —Ñ–∞–π–ª logs.txt.
    } catch (error) {
        console.error("–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø–∏—Å—É –≤ –ª–æ–≥:", error);
    }
    next();
}); // - –õ–æ–≥—É–≤–∞–Ω–Ω—è HTTP-–∑–∞–ø–∏—Ç—ñ–≤ ‚Äî —Ü–µ –æ–¥–Ω–∞ –∑ –æ—Å–Ω–æ–≤ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É —Ç–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏. –û—Å—å –æ—Å–Ω–æ–≤–Ω—ñ –ø—Ä–∏—á–∏–Ω–∏, —á–æ–º—É —Ü–µ —Ä–æ–±–ª—è—Ç—å:
// ‚úÖ 1. –í–∏—è–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫
//       –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–æ–≤—ñ–¥–æ–º–ª—è—î –ø—Ä–æ –ø—Ä–æ–±–ª–µ–º—É, —Ç–∏ –º–æ–∂–µ—à: –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ª–æ–≥, –ø–æ–±–∞—á–∏—Ç–∏, —è–∫—ñ –∑–∞–ø–∏—Ç–∏ –Ω–∞–¥—Ö–æ–¥–∏–ª–∏,—è–∫—ñ —Å–∞–º–µ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤—ñ–¥–¥–∞–≤–∞–≤ —Å–µ—Ä–≤–µ—Ä, —ñ –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —â–æ –ø—ñ—à–ª–æ –Ω–µ —Ç–∞–∫.
// ‚úÖ 2. –ê–Ω–∞–ª—ñ–∑ –±–µ–∑–ø–µ–∫–∏
//       –õ–æ–≥–∏ –º–æ–∂—É—Ç—å –ø–æ–∫–∞–∑–∞—Ç–∏: –ø—ñ–¥–æ–∑—Ä—ñ–ª—ñ —Å–ø—Ä–æ–±–∏ –¥–æ—Å—Ç—É–ø—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—ñ–¥–±—ñ—Ä –ø–∞—Ä–æ–ª—è), –∞—Ç–∞–∫–∏ —Ç–∏–ø—É SQL injection, –∞–±–æ DDOS-–ø–æ–¥—ñ–±–Ω—É –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å. –¶–µ –¥–∞—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤—á–∞—Å–Ω–æ –∑—Ä–µ–∞–≥—É–≤–∞—Ç–∏!
// ‚úÖ 3. –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞ —Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
//       –ú–æ–∂–Ω–∞ –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏: —è–∫—ñ –º–∞—Ä—à—Ä—É—Ç–∏ –Ω–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à—ñ, –∑ —è–∫–∏—Ö IP-–∞–¥—Ä–µ—Å –Ω–∞–π—á–∞—Å—Ç—ñ—à–µ –∑–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è, –≤ —è–∫—ñ –≥–æ–¥–∏–Ω–∏ —Å–µ—Ä–≤–µ—Ä –Ω–∞–π–±—ñ–ª—å—à –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π.
// ‚úÖ 4. –Ü—Å—Ç–æ—Ä—ñ—è –¥—ñ–π
//       –õ–æ–≥ ‚Äî —Ü–µ —è–∫ —á–æ—Ä–Ω–∞ —Å–∫—Ä–∏–Ω—å–∫–∞. –Ø–∫—â–æ —â–æ—Å—å –∑–ª–∞–º–∞–ª–æ—Å—å –∞–±–æ —Å–µ—Ä–≤–µ—Ä –≤–ø–∞–≤, –º–æ–∂–Ω–∞ –¥—ñ–∑–Ω–∞—Ç–∏—Å—å, —â–æ –≤—ñ–¥–±—É–≤–∞–ª–æ—Å—å –¥–æ —Ü—å–æ–≥–æ.
// ‚úÖ 5. –ó–∞–∫–æ–Ω–æ–¥–∞–≤—á—ñ –≤–∏–º–æ–≥–∏
//       –£ –¥–µ—è–∫–∏—Ö –∫—Ä–∞—ó–Ω–∞—Ö —á–∏ —Å—Ñ–µ—Ä–∞—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –±–∞–Ω–∫—ñ–Ω–≥, –æ—Ö–æ—Ä–æ–Ω–∞ –∑–¥–æ—Ä–æ–≤‚Äô—è) –≤–∏–º–æ–≥–∏ –±–µ–∑–ø–µ–∫–∏ –∑–æ–±–æ–≤‚Äô—è–∑—É—é—Ç—å –≤–µ—Å—Ç–∏ –ª–æ–≥–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ —Ç–∞ –∞—É–¥–∏—Ç—ñ–≤.
// üõ†Ô∏è –õ–æ–≥—É—é—Ç—å —É Node.js / Express –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏:
// [`morgan`](https://www.npmjs.com/package/morgan) ‚Äî –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è HTTP-–∑–∞–ø–∏—Ç—ñ–≤,
// [`winston`](https://www.npmjs.com/package/winston) ‚Äî –¥–ª—è –≥–Ω—É—á–∫–æ–≥–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è —É —Ñ–∞–π–ª –∞–±–æ –±–∞–∑—É. 

// –ö—Ä–∞—â–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –ª–æ–≥–∏ –≤ –æ–∫—Ä–µ–º—ñ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:
// /logs/logs.txt –Ü –¥–æ–¥–∞—Ç–∏ —Ü—é –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –≤ .gitignore.
// –õ–æ–≥—É–≤–∞—Ç–∏ –º–æ–∂–Ω–∞ —Ä—ñ–∑–Ω—ñ –¥–∞–Ω—ñ –∑ –∑–∞–ø–∏—Ç—É —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:
//   req.ip ‚Äî IP –∫–ª—ñ—î–Ω—Ç–∞
//   req.headers['user-agent'] ‚Äî —Ç–∏–ø –±—Ä–∞—É–∑–µ—Ä–∞
//   —Å—Ç–∞—Ç—É—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (res.statusCode) ‚Äî –∞–ª–µ –π–æ–≥–æ —Ç—Ä–µ–±–∞ –ª–æ–≤–∏—Ç–∏ –ø—ñ—Å–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –¥–ª—è —Ü—å–æ–≥–æ —Ç—Ä–µ–±–∞ –¥–æ–¥–∞—Ç–∏ –æ–±—Ä–æ–±–Ω–∏–∫ res.on('finish', ...)


// –û–±—Ä–æ–±–∏–º–æ –ø–æ–º–∏–ª–∫—É 404, —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ –Ω–µ—ñ—Å–Ω—É—é—á–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é middleware:
app.use((req, res) => {
    res.status(404).send("<h1>404 - –°—Ç–æ—Ä—ñ–Ω–∫—É –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!</h1>");
});
// –∞–±–æ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ —Ç–∞–∫:
app.use((req, res) => {
    res.status(404).json({
        error: "–°—Ç–æ—Ä—ñ–Ω–∫—É –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!",
        status: 404,
        message: "–°—Ç–æ—Ä—ñ–Ω–∫–∞, —è–∫—É –≤–∏ —à—É–∫–∞—î—Ç–µ, –Ω–µ —ñ—Å–Ω—É—î."
    });
});

// –©–µ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é middleware –º–æ–∂–Ω–∞ –æ–±—Ä–æ–±–ª—è—Ç–∏ –ø–æ–º–∏–ª–∫–∏ CORS (Cross-Origin Resource Sharing), —Ç–æ–±—Ç–æ –¥–æ–∑–≤–æ–ª—è—Ç–∏ –∑–∞–ø–∏—Ç–∏ –∑ —ñ–Ω—à–∏—Ö –¥–æ–º–µ–Ω—ñ–≤. –¶–µ –≤–∞–∂–ª–∏–≤–æ, —è–∫—â–æ —Ç–≤—ñ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —ñ –±–µ–∫–µ–Ω–¥ —Ä–æ–∑–º—ñ—â–µ–Ω—ñ –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –¥–æ–º–µ–Ω–∞—Ö –∞–±–æ –ø–æ—Ä—Ç–∞—Ö. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–∞ localhost:3000, –∞ –±–µ–∫–µ–Ω–¥ –Ω–∞ localhost:5000, —Ç–æ –±—Ä–∞—É–∑–µ—Ä –º–æ–∂–µ –±–ª–æ–∫—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏ —á–µ—Ä–µ–∑ –ø–æ–ª—ñ—Ç–∏–∫—É –±–µ–∑–ø–µ–∫–∏. –©–æ–± —Ü—å–æ–≥–æ —É–Ω–∏–∫–Ω—É—Ç–∏, –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ middleware –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è CORS:
const cors = require ("cors"); // npm i cors
app.use(cors({
    origin: "http://localhost:3000", // –î–æ–∑–≤–æ–ª—è—î–º–æ –∑–∞–ø–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ –∑ —Ü—å–æ–≥–æ –¥–æ–º–µ–Ω—É
    methods: ["GET", "POST", "PUT", "DELETE"], // –î–æ–∑–≤–æ–ª—è—î–º–æ —Ü—ñ –º–µ—Ç–æ–¥–∏
    credentials: true // –î–æ–∑–≤–æ–ª—è—î–º–æ –ø–µ—Ä–µ–¥–∞—á—É –∫—É–∫—ñ–≤
})); // –¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å —Ç–≤–æ—î–º—É —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É –Ω–∞ localhost:3000 —Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç–∏ –¥–æ –±–µ–∫–µ–Ω–¥—É –Ω–∞ localhost:5000 –±–µ–∑ –ø–æ–º–∏–ª–æ–∫ CORS.
// –∞–±–æ —è–∫—â–æ —è —Ö–æ—á—É –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–∞–ø–∏—Ç–∏ –∑ —É—Å—ñ—Ö –¥–æ–º–µ–Ω—ñ–≤, –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ —Ç–∞–∫:
app.use(cors({
    origin: "*", // –î–æ–∑–≤–æ–ª—è—î–º–æ –∑–∞–ø–∏—Ç–∏ –∑ —É—Å—ñ—Ö –¥–æ–º–µ–Ω—ñ–≤
    methods: ["GET", "POST", "PUT", "DELETE"], // –î–æ–∑–≤–æ–ª—è—î–º–æ —Ü—ñ –º–µ—Ç–æ–¥–∏
    credentials: true // –î–æ–∑–≤–æ–ª—è—î–º–æ –ø–µ—Ä–µ–¥–∞—á—É –∫—É–∫—ñ–≤
}));
// –∞–±–æ —Ç–∞–∫:
app.use(cors()); // –¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –∑–∞–ø–∏—Ç–∏ –∑ —É—Å—ñ—Ö –¥–æ–º–µ–Ω—ñ–≤ —ñ –≤—Å—ñ—Ö –º–µ—Ç–æ–¥—ñ–≤. –ê–ª–µ —Ü–µ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è —Ä–æ–±–∏—Ç–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω, –±–æ –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–±–µ–∑–ø–µ—á–Ω–æ. –ö—Ä–∞—â–µ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –¥–æ–º–µ–Ω–∏, –∑ —è–∫–∏—Ö –¥–æ–∑–≤–æ–ª–µ–Ω—ñ –∑–∞–ø–∏—Ç–∏.



// –ù–µ –∑—Ä—É—á–Ω–æ —Ä–æ–±–∏—Ç–∏ –≤—Å—ñ –∑–∞–ø–∏—Ç–∏ –≤ app.js, —Ç–æ–º—É —Å—Ç–≤–æ—Ä—é—î–º–æ –æ–∫—Ä–µ–º–∏–π —Ñ–∞–π–ª –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ REST API, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, routes/api/books.js (–¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å—É –º–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –æ–∫—Ä–µ–º–∏–π —Ñ–∞–π–ª, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, books.js, users.js —ñ —Ç.–¥.).
// routes/api/books.js
const express = require("express");
const router = express.Router(); // app - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–µ—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –¥–ª—è –∑–∞–ø—É—Å–∫—É –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä—É, –∞ —è–∫–∑—â–æ –º–∏ —Ö–æ—á–µ–º–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –æ–∫—Ä–µ–º–∏–π —Ä–æ—É—Ç–µ—Ä –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ API, —Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ express.Router().
const books = require("../../data/books.json"); // –ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, —â–æ —É –Ω–∞—Å —î —Ñ–∞–π–ª books.json –∑ –¥–∞–Ω–∏–º–∏ –∫–Ω–∏–≥.
router.get("/", (req, res) => { // –û—Ç—Ä–∏–º–∞–Ω–Ω—è –≤—Å—ñ—Ö –∫–Ω–∏–≥
    res.json(books); // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –º–∞—Å–∏–≤ –∫–Ω–∏–≥ —É —Ñ–æ—Ä–º–∞—Ç—ñ JSON
});
router.get("/:id", (req, res) => { // –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–Ω–∏–≥–∏ –∑–∞ ID
    req.json(books[0]); // –û—Ç—Ä–∏–º—É—î–º–æ ID –∫–Ω–∏–≥–∏ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ URL
});

module.exports = router; // –ï–∫—Å–ø–æ—Ä—Ç—É—î–º–æ —Ä–æ—É—Ç–µ—Ä, —â–æ–± –π–æ–≥–æ –º–æ–∂–Ω–∞ –±—É–ª–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤ —ñ–Ω—à–∏—Ö —Ñ–∞–π–ª–∞—Ö.

// app.js
import express from "express";
const cors = require("cors");
import booksRouter from "./routes/api/books.js"; // –Ü–º–ø–æ—Ä—Ç—É—î–º–æ —Ä–æ—É—Ç–µ—Ä –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –∫–Ω–∏–≥–∞–º–∏
// const app = express();
app.use(cors()); // –î–æ–¥–∞—î–º–æ CORS, —â–æ–± –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–∞–ø–∏—Ç–∏ –∑ —ñ–Ω—à–∏—Ö –¥–æ–º–µ–Ω—ñ–≤
app.use(express.json()); // –î–æ–¥–∞—î–º–æ middleware –¥–ª—è –æ–±—Ä–æ–±–∫–∏ JSON-—Ç bodies –∑–∞–ø–∏—Ç
app.use("/api/books", booksRouter); // –Ø–∫—â–æ –∑–∞–ø–∏—Ç –¥–æ API –ø–æ—á–∏–Ω–∞–ª–∏—Å—è –∑ /api/books, —Ç–æ —Ç–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —à—É–∫–∞–π –≤ booksRouter, —Ç–æ–±—Ç–æ –≤ routes/api/books.js
app.use((req, res) => { // –Ø–∫—â–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∂–æ–¥–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç—É, —Ç–æ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ 404
    res.status(404).json({ message: "Not Found" });
});
// –ó–∞–ø—É—Å–∫–∞—î–º–æ —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 3000
app.listen(3000, () => {
    console.log("Server running on http://localhost:3000");
});


// –º–µ—Ç–æ–¥–∏ HTTP –¥–ª—è REST API:
// 1. GET ‚Äî –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥)
router.get("/", async (req, res) => {
    try {
        const data = await readFile("./books.json", "utf-8");
        const books = JSON.parse(data); // –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ —Ç–µ–∫—Å—Ç JSON —É –º–∞—Å–∏–≤ –æ–±'—î–∫—Ç—ñ–≤
        res.json(books); // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –º–∞—Å–∏–≤ –∫–Ω–∏–≥ —É —Ñ–æ—Ä–º–∞—Ç—ñ JSON
    } catch (error) {
        return res.status(500).json({ message: "–ü–æ–º–∏–ª–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞" }); // –Ø–∫—â–æ —Å—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞, –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ 500
    }
});

// –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–Ω–∏–≥–∏ –∑–∞ ID
router.get("/:id", async (req, res) => {
    try {
        const data = await readFile("./books.json", "utf-8");
        const books = JSON.parse(data);
        const book = books.find(b => b.id === parseInt(req.params.id));
        if (!book) {
            throw HttpError(404, `–ö–Ω–∏–≥–∞ –∑ ID ${req.params.id} –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞`); // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é HttpError –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏. req.params - —Ü–µ –æ–±'—î–∫—Ç, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –º–∞—Ä—à—Ä—É—Ç—É, –≤ –¥–∞–Ω–Ω–æ–º—É –≤–∏–ø–∞–¥–∫—É —Ü–µ ID –∫–Ω–∏–≥–∏, —è–∫—É –º–∏ —à—É–∫–∞—î–º–æ.
            // –∞–±–æ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ —Ç–∞–∫:
            // const error = new Error("–ö–Ω–∏–≥–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞");
            // error.status = 404; // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç—É—Å 404, —è–∫—â–æ –∫–Ω–∏–≥–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞
            // throw error; // –ì–µ–Ω–µ—Ä—É—î–º–æ –ø–æ–º–∏–ª–∫—É, —â–æ–± –ø–µ—Ä–µ–¥–∞—Ç–∏ —ó—ó –¥–∞–ª—ñ –≤ middleware –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫
        } // —Ü—é –ø–µ—Ä–µ–≤—ñ–æ–∫—É –º–∏ –º–æ–∂–∫–º–æ –≤–∏–Ω–µ—Å—Ç–∏ –≤ –æ–∫—Ä–µ–º–∏–π —Ñ–∞–π–ª helper.js (–¥–∏–≤–∏—Å—å –Ω–∏–∂—á–µ), —â–æ–± –Ω–µ –¥—É–±–ª—é–≤–∞—Ç–∏ –∫–æ–¥ –≤ –∫–æ–∂–Ω–æ–º—É —Ä–æ—É—Ç—ñ
        res.json(book);
    } catch (error) {
        // return res.status(500).json({ message: "–ü–æ–º–∏–ª–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞" }); // –∑–∞–º—ñ—Å—Ç—å –æ–±—Ä–æ–±–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏ –º–∏ –º–æ–∂–µ–º –≤ –Ω–∞—à–æ–º—É get –∑–∞–ø–∏—Ç—ñ –ø–µ—Ä–µ–¥–∞—Ç–∏ —Ç—Ä–µ—Ç—ñ–π –ø–∞—Ä–∞–º–µ—Ç—Ä next —ñ —Ç—É—Ç –≤–∏–∫–ª–∏–∫–∞—Ç–∏ next –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º error 
        next(error); // next(error) - —à—É–∫–∞—î –æ–±—Ä–æ–±–Ω–∏–∫ –ø–æ–º–∏–ª–æ–∫, —è–∫–∏–π –º–∞—î —á–æ—Ç–∏—Ä–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ (err, req, res, next). –Ø–∫—â–æ —Ç–∞–∫–∏–π –æ–±—Ä–æ–±–Ω–∏–∫ –∑–Ω–∞–π–¥–µ—Ç—å—Å—è, —Ç–æ –≤—ñ–Ω –±—É–¥–µ –≤–∏–∫–ª–∏–∫–∞–Ω–∏–π –∑ –ø–µ—Ä–µ–¥–∞–Ω–æ—é –ø–æ–º–∏–ª–∫–æ—é. –Ø–∫—â–æ –Ω—ñ, —Ç–æ Express –≤—ñ–¥–¥–∞—Å—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É –ø–æ–º–∏–ª–∫—É 500. 
    }
});

// 2. POST ‚Äî —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ—ó –∫–Ω–∏–≥–∏)
app.use(express.json()); // –î–æ–¥–∞—î–º–æ middleware –¥–ª—è –æ–±—Ä–æ–±–∫–∏ JSON-—Ç bodies –∑–∞–ø–∏—Ç—ñ–≤
// –¶–µ –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–º –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –∑ —Ç—ñ–ª–∞ –∑–∞–ø–∏—Ç—É (req.body), —è–∫—â–æ –Ω–µ –±—É–∂–µ —Ü–±–æ–≥–æ middleware, —Ç–æ req.body –±—É–¥–µ undefined —ñ –º–∏ –Ω–µ –∑–º–æ–∂–µ–º–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ –∑ —Ç—ñ–ª–∞ –∑–∞–ø–∏—Ç—É.

//–î–ª—è —Ç–æ–≥–æ —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ –Ω–∞–º –ø—Ä–∏–π—à–ª–∏ –¥–∞–Ω—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ –±—ñ—å–ª—ñ–æ—Ç–µ–∫—É Joi, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Å—Ö–µ–º–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –¥–ª—è –æ–±'—î–∫—Ç—ñ–≤. –í–æ–Ω–∞ –¥–æ–ø–æ–º–∞–≥–∞—î –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏, —á–∏ –¥–∞–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –æ—á—ñ–∫—É–≤–∞–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É, —ñ –≤–∏–¥–∞—î –ø–æ–º–∏–ª–∫–∏, —è–∫—â–æ —â–æ—Å—å –Ω–µ —Ç–∞–∫.
// import Joi = require("joi"); // npm i joi
const bookAddSchema = Joi.object({ // –°—Ç–≤–æ—Ä—é—î–º–æ —Å—Ö–µ–º—É –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –¥–ª—è –Ω–æ–≤–æ—ó –∫–Ω–∏–≥–∏
    title: Joi.string().min(3).required(), // –ù–∞–∑–≤–∞ –∫–Ω–∏–≥–∏ –º–∞—î –±—É—Ç–∏ —Ä—è–¥–∫–æ–º, –º—ñ–Ω—ñ–º—É–º 3 —Å–∏–º–≤–æ–ª–∏, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ –ø–æ–ª–µ
    author: Joi.string().required(), // –ê–≤—Ç–æ—Ä –º–∞—î –±—É—Ç–∏ —Ä—è–¥–∫–æ–º, –º—ñ–Ω—ñ–º—É–º 3 —Å–∏–º–≤–æ–ª–∏, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ –ø–æ–ª–µ
    year: Joi.number().min(1000).max(9999).required() // –†—ñ–∫ –º–∞—î –±—É—Ç–∏ —á–∏—Å–ª–æ–º, –≤ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ –≤—ñ–¥ 1000 –¥–æ 9999, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ –ø–æ–ª–µ
});
router.post("/", async (req, res, next) => {
    try {
        const { error } = bookAddSchema.validate(req.body); // –í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö –∑ —Ç—ñ–ª–∞ –∑–∞–ø–∏—Ç—É
        if(error) {
            throw HttpError(400, error.message); // –Ø–∫—â–æ –¥–∞–Ω—ñ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —Å—Ö–µ–º—ñ, –∫–∏–¥–∞—î–º–æ –ø–æ–º–∏–ª–∫—É 400 (Bad Request)
        }
        // console.log(req.body); // req.body –º—ñ—Å—Ç–∏—Ç—å –¥–∞–Ω—ñ, —è–∫—ñ –±—É–ª–∏ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –≤ —Ç—ñ–ª—ñ –∑–∞–ø–∏—Ç—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –Ω–æ–≤–æ—ó –∫–Ω–∏–≥–∏)`);
        const newBook = await readFile("./books.json", "utf-8");
        const books = JSON.parse(newBook); // –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ —Ç–µ–∫—Å—Ç JSON —É –º–∞—Å–∏–≤ –æ–±'—î–∫—Ç—ñ–≤
        const book = {
            id: books.length + 1,
            title: req.body.title,
            author: req.body.author,
            year: req.body.year
        };
        books.push(book);
        await writeFile("./books.json", JSON.stringify(books, null, 2));
        res.status(201).json(book); // –ø–µ—Ä–µ–¥–∞—î–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å—Ç—É—Ç—É—Å 201 (Created) —ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ —Å—Ç–≤–æ—Ä–µ–Ω—É –∫–Ω–∏–≥—É —É —Ñ–æ—Ä–º–∞—Ç—ñ JSON
    } catch (error) {
        next(error); // –ü–µ—Ä–µ–¥–∞—î–º–æ –ø–æ–º–∏–ª–∫—É –¥–∞–ª—ñ –≤ middleware –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫
    }
})

// 3. PUT ‚Äî –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ—Å–Ω—É—é—á–∏—Ö –¥–∞–Ω–∏—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–º—ñ–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –∫–Ω–∏–≥—É)
router.put("/:id", async (req, res, next) => {
    try {
       const { error } = bookAddSchema.validate(req.body);
        if(error) {
            throw HttpError(400, error.message);
        }
        const { id } = req.params; // –û—Ç—Ä–∏–º—É—î–º–æ ID –∫–Ω–∏–≥–∏ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ URL
        const data = await readFile("./books.json", "utf-8");
        const books = JSON.parse(data);
        const bookIndex = books.findIndex(b => b.id === parseInt(id)); // –ó
        }
    catch (error) {
        next(error); // –ü–µ—Ä–µ–¥–∞—î–º–æ –ø–æ–º–∏–ª–∫—É –¥–∞–ª—ñ –≤ middleware –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫
    }
});

// 4. DELETE ‚Äî –≤–∏–¥–∞–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∫–Ω–∏–≥–∏) 
router.delete("/:id", async (req, res, next) => {
    try {
        const { id } = req.params; // –û—Ç—Ä–∏–º—É—î–º–æ ID –∫–Ω–∏–≥–∏ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ URL
        const data = await readFile("./books.json", "utf-8");
        const books = JSON.parse(data);
        const bookIndex = books.findIndex(b => b.id === parseInt(id));
        if (bookIndex === -1) {
            throw HttpError(404, `–ö–Ω–∏–≥–∞ –∑ ID ${id} –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞`);
        }
        books.splice(bookIndex, 1); // –í–∏–¥–∞–ª—è—î–º–æ –∫–Ω–∏–≥—É –∑ –º–∞—Å–∏–≤—É
        await writeFile("./books.json", JSON.stringify(books, null, 2));
        res.status(204).send(); // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ —Å—Ç–∞—Ç—É—Å 204 (No Content) –±–µ–∑ —Ç—ñ–ª–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
        res.json({ message: "–ö–Ω–∏–≥–∞ –≤–∏–¥–∞–ª–µ–Ω–∞" }); // –ê–±–æ –º–æ–∂–Ω–∞ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—à–Ω–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è        
    } catch (error) {
        next(error);
    }
});


// helper/ HttpError.js
const HttpError = (status, message) => {
    const error = new Error(message);
    error.status = status;
    return error;
};
